---
title: "COVID-19 Survey Analysis"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## **Exploratory Analysis**

### **Introduction** 

We are researching the mental health statistics due to COVID-19 because of the current situation we are living in. This dataset has given us unique questions that allow us to see how people are reacting to the Covid pandemic during their daily life. From measuring the amount of time people communicate with their family/friends, rating one’s mental health from excellent to poor, and using their gender as a means of comparison this data gives us an insight on how Covid-19 has impacted our mental health. Now more than ever are we more aware of taking care of one's mental health and we can use this data to better understand Covid’s affect on individuals. 

### **Summary Information Script**

From our 3 charts we are able to gather a lot of information about the mental health impact of Covid on the sample population. We see from the question “how do you rate year health” 417 people that live by themselves said they felt excellent. That is a low number compared to the rest of the population, because we know that living by yourself leads to more loneliness. From our chart we were also able to compare the amount of men and women that said they felt “excellent” during the pandemic 838 females said they felt excellent while only 642 males said they felt excellent. We can see from this data and other health statistics that males often have more depression compared to women. One other observation we made from our data was the increase in the number of people that communicated with their friends and family once covid began. Before covid 4,163 people said they communicated with friends and family “basically every day”, but when covid began 4,940 people said they talked with their family/ friend everyday. We see that people were more likely to communicate with their friends and family once Covid began.

<<<<<<< HEAD
=======

>>>>>>> 083087a37bdde50ed707f302ac6ca86b470ccb03
### **Table of Aggregated Data**


### **First Chart:** _Histogram of Mental Health Ratings by Gender_

```{r, echo = FALSE, include = F, warning = FALSE}
library(ggplot2)
library(dplyr)
library(tidyverse)
# Histogram of Mental Health Ratings/Amount of Responses separated by Gender----

dataset <- read.csv("https://query.data.world/s/x7qrjzoufcjzx6agzg5d6omncpzup7", header=TRUE, stringsAsFactors=FALSE)
colnames(dataset)
names(dataset)[names(dataset) == "PHYS8"] <- "how would you rate your health"
names(dataset)[names(dataset) == "GENDER"] <- "gender"

dataset2 <- dataset %>%  select(`how would you rate your health`, gender)
```

```{r, echo =FALSE, warning = FALSE}

# Start of the histogram (run everything before in the right order first)

dataset5 <- dataset2 %>%
  select(`how would you rate your health`, gender) %>%
  filter(`how would you rate your health` != "(98) SKIPPED ON WEB") %>%
  filter(gender != "(98) SKIPPED ON WEB") %>%
  filter(`how would you rate your health` != "(77) DON'T KNOW")

dataset5$`how would you rate your health` <- as.character(dataset5$`how would you rate your health`)
dataset5[dataset5 == "(1) Excellent"] <- "Excellent"
dataset5[dataset5 == "(2) Very good"] <- "Very Good"
dataset5[dataset5 == "(3) Good"] <- "Good"
dataset5[dataset5 == "(4) Fair"] <- "Fair"
dataset5[dataset5 == "(5) Poor"] <- "Poor"
dataset5$`how would you rate your health` <- as.factor(dataset5$`how would you rate your health`)

names(dataset5)[names(dataset5) == "how would you rate your health"] <- "Mental Health Rating"

ggplot(data = dataset5, mapping = aes(x = `Mental Health Rating`, fill = `Mental Health Rating`)) + 
  geom_histogram(binwidth = 1, stat = "count") +
  labs(x = "Level of Mental Health", y = "Amount of Responses") +
  facet_wrap(~gender, labeller = "label_both") 
```

We decided to include this chart to see and showcase the similarities between
each gender and their personal _ratings for their mental health_. This histogram
is organized and clear in a manner that reflects a pattern of a high number of `“Very Good”` and `“Good”` ratings across both males and females. The
**purpose** of this chart is to break down the data set from one question to gather insight about how males and females have viewed their level of mental health. Some **notable** observations and insights from the chart include the evidence of how most males and females rated their level of mental health as
`“Very Good”`. The histogram is color-coded to more clearly highlight each
possible response and the number of those responses in the data that clearly
show the same order of the number of responses. For both males and females, the highest number of responses were under `“Very Good”`, then continued in the order
of `“Good”`, `“Excellent”`, `“Fair”` and then both having the lowest number of
responses for `“Poor”`.

### **Second Chart:** Stacked Bar Chart of How Often People Communicated

```{r, include= FALSE}

names(dataset)[names(dataset) == "SOC1"] <- "how much do you trust your neighborhood"
names(dataset)[names(dataset) == "SOC2A"] <- "talk with neighbor in month"
names(dataset)[names(dataset) == "SOC2B"] <- "talk with neighbor in month before covid"
names(dataset)[names(dataset) == "SOC3A"] <- "how often did you stay in touch with family/friends"
names(dataset)[names(dataset) == "SOC3B"] <- "how often did you stay in touch with family/friend before covid"

dataset2 <- dataset %>%  select(`how much do you trust your neighborhood`:`how often did you stay in touch with family/friend before covid`)

dataset3 <- dataset2 %>%
  select( `talk with neighbor in month` : `how often did you stay in touch with family/friend before covid`)

dataset3$`talk with neighbor in month` <- as.character(dataset3$`talk with neighbor in month`)
dataset3[dataset3 == "(1) Basically every day"] <- "Basically every day"
dataset3[dataset3 == "(2) A few times a week"] <- "A few times a week"
dataset3[dataset3 == "(3) A few times a month"] <- "A few times a month"
dataset3[dataset3 == "(4) Once a month"] <- "Once a month"
dataset3[dataset3 == "(5) Not at all"] <- "Not at all"
dataset3[dataset3 == "(98) SKIPPED ON WEB"] <- "Skipped on web"
dataset3[dataset3 == "(77) Not sure"] <- "Not sure"
dataset3$`talk with neighbor in month` <- as.factor(dataset3$`talk with neighbor in month`)

names(dataset3)[names(dataset3) == "talk with neighbor in month"] <- "1"
names(dataset3)[names(dataset3) == "talk with neighbor in month before covid"] <- "2"
names(dataset3)[names(dataset3) == "how often did you stay in touch with family/friends"] <- "3"
names(dataset3)[names(dataset3) == "how often did you stay in touch with family/friend before covid"] <- "4"
```
```{r, echo=FALSE}
data_items <- dataset3 %>% 
  select(`1`:`4`) %>%
  na.omit

library(tidyverse)
library(dplyr)

data_items %>%  
  gather(key = Questions, value = Responses) %>% 
  mutate(Responses = factor(Responses)) %>% 
  ggplot(aes(x = Questions)) + 
  geom_bar(aes(fill = Responses), position = "fill") -> interactions
interactions + scale_fill_brewer(palette = "Spectral")
```



In this chart we are comparing people’s responses on how often they talked to their neighbors before and during COVID-19. `Row 1` asked the question “How often did you talk to your neighbors?” `Row 2` asks “How often did you talk to your neighbors during COVID-19?”. `Row 3` asks “How often did you stay in touch with your family and friends during quarantine?” `Row 4` asks “How often did you stay in touch with your family and friends BEFORE COVID-19?” We thought it was important to include this data because it demonstrates how more people reached out to their friends and family when the pandemic started.

An interesting observation we made was that when people talked to their family and friends `“Basically every day”` compared to the people who only talked to their family and friends `“A few times a week”`. Another observation is there was hardly any change with how often people communicated with their neighbors before or during quarantine.

### **Third Chart:** 
<<<<<<< HEAD
=======
```{r, echo = FALSE}

names(dataset)[names(dataset) == "SOC1"] <- "how much do you trust your neighborhood"
names(dataset)[names(dataset) == "SOC2A"] <- "talk with neighbor in month"
names(dataset)[names(dataset) == "SOC2B"] <- "talk with neighbor in month before covid"
names(dataset)[names(dataset) == "SOC3A"] <- "how often did you stay in touch with family/friends"
names(dataset)[names(dataset) == "SOC3B"] <- "how often did you stay in touch with family/friend before covid"
names(dataset)[names(dataset) == "SOC4A"] <- "did you volunteer this month"
names(dataset)[names(dataset) == "SOC4B"] <- "how often did you volunteer per month before covid"
names(dataset)[names(dataset) == "PHYS8"] <- "how would you rate your health"
names(dataset)[names(dataset) == "SOC5"] <- "in the past 7 days have you felt anxious/depressed/lonely/hopeless"
names(dataset)[names(dataset) == "GENDER"] <- "gender"
names(dataset)[names(dataset) == "RACETH"] <- "race"
names(dataset)[names(dataset) == "HHSIZE1"] <- "household size"

New_data <- dataset %>%  select(`how much do you trust your neighborhood`:`how would you rate your health`, `household size`, gender, RACE_R2 , EDUCATION, P_GEO)

chart3 <- New_data %>% 
  filter(`how would you rate your health` !=  "(98) SKIPPED ON WEB") %>% 
  filter(`household size` != "(99) REFUSED") %>% 
  filter(`household size` != "(98) SKIPPED ON WEB")

chart3$`how would you rate your health` <- as.character(chart3$`how would you rate your health`)
chart3[chart3 == "(1) Excellent"] <- "Excellent"
chart3[chart3 == "(2) Very good"] <- "Very Good"
chart3[chart3 == "(3) Good"] <- "Good"
chart3[chart3 == "(4) Fair"] <- "Fair"
chart3[chart3 == "(5) Poor"] <- "Poor"
chart3[chart3 == "(77) DON'T KNOW"] <- "Don't Know"
chart3$`how would you rate your health` <- as.factor(chart3$`how would you rate your health`)

chart3$`household size` <- as.character(chart3$`household size`)
chart3[chart3 == "(1) One person, I live by myself"] <- "One person, I live by myself"
chart3[chart3 == "(2) Two persons"] <- "Two persons"
chart3[chart3 == "(3) Three persons"] <- "Three persons"
chart3[chart3 == "(4) Four persons"] <- "Four persons"
chart3[chart3 == "(5) Five persons"] <- "Five persons"
chart3[chart3 == "(6) Six or more persons"] <- "Six or more persons"
chart3$`household size` <- as.factor(chart3$`household size`)

ggplot(data = chart3) +
  geom_count(mapping = aes(x= `how would you rate your health`, y = `household size`))


  
```

In this scatterplot we are showing how people rated their health during Covid-19 compared to the amount of people that live in a household. The scatterplot shows that the bigger the bubble is the more people that are in the category. This chart is important because it shows how much having another person in your household affects the way you are feeling mentally.  Each bubble size is seperated by 250, 500, 750, and 1,000 people.

From our observation the plot that had the most people was “Two Person” household and they felt “very good”. The column that shows us the most clear evidence of covid’s impact on people who live by themselves is the people who feel “poor” column. As the number of people in a household increases the less people say that they feel “poor”.  
